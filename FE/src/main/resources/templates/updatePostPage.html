<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- Google Fonts -->
    <link
            href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
            rel="stylesheet" />

    <!-- Font Awesome Icons -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
            integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/postFormPage.css}" />
</head>
<body>
<!-- =============================
     HEADER SECTION
     ============================= -->
<header th:include="/commonComponents/header.html"></header>
<!-- =============================
     MAIN SECTION
     ============================= -->
<div class="registration">
    <div class="registration__header">
        <div class="registration__header__breadcrumb">
            <a href="#" class="registration__header__breadcrumb-link"
            >Trang chủ</a
            >
            <span class="registration__header__breadcrumb-separator">/</span>
            <span class="registration__header__breadcrumb-current">Cập nhật tin</span>
        </div>
        <h1 class="registration__title">CẬP NHẬT TIN</h1>
        <div class="registration__divider"></div>
    </div>

    <form th:action="@{/home/store/updatePost}" method="post" th:object="${post}"  enctype="multipart/form-data" class="registration__content">
        <input type="hidden" th:field="*{postsId}" />
        <input type="hidden" th:field="*{images}" />

        <div class="registration__left">
            <div class="registration__upload-section">
                <label class="registration__label">
                    ẢNH CHÍNH <span class="registration__required">*</span>
                </label>
                <div class="registration__upload-box">
                    <div class="registration__upload-icon">
                        <svg th:if="${post.getImages() == null}" width="80" height="80" viewBox="0 0 80 80" fill="none">
                            <rect width="80" height="80" rx="8" fill="#f5f5f5" />
                            <path
                                    d="M40 25C34.477 25 30 29.477 30 35C30 40.523 34.477 45 40 45C45.523 45 50 40.523 50 35C50 29.477 45.523 25 40 25Z"
                                    fill="#d0d0d0"
                            />
                            <path
                                    d="M25 50C25 47.239 27.239 45 30 45H50C52.761 45 55 47.239 55 50V55H25V50Z"
                                    fill="#d0d0d0"
                            />
                            <circle cx="55" cy="30" r="8" fill="#d0d0d0" />
                            <path
                                    d="M59 30H61M55 26V24M55 34V36M51 30H49"
                                    stroke="white"
                                    stroke-width="2"
                                    stroke-linecap="round"
                            />
                        </svg>
                        <img th:if="${post.getImages() != null}" th:src="${post.getImages().get(0)}" alt="Main Image" />
                    </div>
                    <p class="registration__upload-text">
                        Phần ảnh chính, thêm tối đa 1 ảnh
                        <span class="registration__required">*</span>
                    </p>
                    <div class="registration__file-upload-form">
                        <input type="file" name="mainImage" id="mainImage" class="registration__file-input" accept="image/*"  />
                    </div>
                    <p th:if="${mainImageError != null}" style="color: red" th:text="${mainImageError}"></p>
                </div>
                <button class="registration__upload-button">Cập nhật ảnh chính</button>
            </div>

            <div class="registration__upload-section">
                <label class="registration__label">
                    ẢNH PHỤ <span class="registration__required">*</span>
                </label>
                <div class="registration__upload-box">
                    <div class="registration__upload-icon">
                        <svg  th:if="${post.getImages() == null}" width="80" height="80" viewBox="0 0 80 80" fill="none">
                            <rect width="80" height="80" rx="8" fill="#f5f5f5" />
                            <path
                                    d="M40 25C34.477 25 30 29.477 30 35C30 40.523 34.477 45 40 45C45.523 45 50 40.523 50 35C50 29.477 45.523 25 40 25Z"
                                    fill="#d0d0d0"
                            />
                            <path
                                    d="M25 50C25 47.239 27.239 45 30 45H50C52.761 45 55 47.239 55 50V55H25V50Z"
                                    fill="#d0d0d0"
                            />
                            <circle cx="55" cy="30" r="8" fill="#d0d0d0" />
                            <path
                                    d="M59 30H61M55 26V24M55 34V36M51 30H49"
                                    stroke="white"
                                    stroke-width="2"
                                    stroke-linecap="round"
                            />
                        </svg>
                        <img th:if="${post.getImages() != null && post.getImages().size() > 1 && start.index > 0}" th:each="image, start :${post.getImages()}" th:src="${image}"  alt="Sub Image" />
                    </div>
                    <p class="registration__upload-text">
                        Phần ảnh phụ, thêm tối đa 4 ảnh
                        <span class="registration__required">*</span>
                    </p>
                    <div class="registration__file-upload-form">
                        <input type="file" name="subImages" id="subImage" class="registration__file-input" accept="image/*" multiple/>
                    </div>
                    <p th:if="${subImagesError != null}" style="color: red" th:text="${subImagesError}"></p>
                </div>
                <button class="registration__upload-button">Cập nhật ảnh phụ</button>
            </div>
        </div>

        <div class="registration__right">
            <div class="registration__section">
                <h2 class="registration__section-title">
                    TIÊU ĐỀ TIN ĐĂNG VÀ MÔ TẢ CHI TIẾT
                </h2>

                <div class="registration__form-group">
                    <input
                            type="text"
                            class="registration__input"
                            placeholder="Tiêu đề *"
                            th:field="*{title}"
                            required
                    />
                </div>

                <div class="registration__form-group">
              <textarea
                      class="registration__textarea"
                      placeholder="Mô tả chi tiết *"
                      th:field="*{description}"
                      rows="4"
              ></textarea>
                </div>
            </div>

            <div class="registration__section">
                <h2 class="registration__section-title">THÔNG TIN CHI TIẾT</h2>

                <div class="registration__form-group">
                    <select class="registration__select" th:field="*{product.productType}" required>
                        <option th:value="${post.getProduct().getProductType()}"
                                th:text="${post.getProduct().getProductType().equals('VEHICLE') ? 'Xe cộ' : 'pin'}" >Xe cộ</option>
<!--                        <option value="BATTERY">Pin</option>-->
                    </select>
                </div>
                <div class="registration__form-group">
                    <input
                            type="text"
                            class="registration__input"
                            placeholder="Tên sản phẩm *"
                            required
                            th:field="*{product.productName}"
                    />
                </div>
                <div class="registration__form-group">
                <textarea
                        class="registration__textarea"
                        placeholder="Mô tả sản phẩm *"
                        rows="4"
                        th:field="*{product.description}"
                ></textarea>
                </div>
                <div th:if="${post.getProduct().getVehicle() != null}" class="vehicle active">
                    <div class="registration__form-group">
                        <select class="registration__select" name="productStatus" th:field="*{product.status}" required>
                            <option value="USED">Đã qua sử dụng</option>
                            <option value="NEW">Mới</option>
                        </select>
                    </div>

                    <div class="registration__form-group">
                        <input
                                type="text"
                                class="registration__input"
                                placeholder="Hãng xe *"
                                required
                                th:field="*{product.vehicle.brand}"
                        />
                    </div>

                    <div class="registration__form-group">
                        <input
                                type="text"
                                class="registration__input"
                                placeholder="Năm sản xuất *"
                                required
                                th:field="*{product.vehicle.registrationYear}"
                        />
                        <p th:if="${yearError != null}" th:text="${yearError}" style="color: red"></p>
                    </div>

                    <div class="registration__form-row">
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="text"
                                    class="registration__input"
                                    placeholder="Xuất xứ *"
                                    required
                                    th:field="*{product.vehicle.origin}"
                            />
                        </div>
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="number"
                                    class="registration__input"
                                    placeholder="Số Km đã di *"
                                    th:field="*{product.vehicle.mileage}"
                                    required
                            />
                        </div>
                    </div>

                    <div class="registration__form-row">
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="text"
                                    class="registration__input"
                                    placeholder="Dung tích pin *"
                                    required
                                    th:field="*{product.vehicle.batteryCapacity}"
                            />
                            <p th:if="${batteryCapacityError != null}" th:text="${batteryCapacityError}" style="color: red"></p>
                        </div>
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="text"
                                    class="registration__input"
                                    placeholder="Dòng xe *"
                                    required
                                    th:field="*{product.vehicle.model}"
                            />
                        </div>
                    </div>

                    <div class="registration__form-group">
                        <input
                                type="text"
                                class="registration__input"
                                placeholder="Tình trạng xe *"
                                th:field="*{product.vehicle.condition}"
                                required
                        />
                    </div>

                    <div class="registration__form-group">
                        <input
                                type="text"
                                class="registration__input"
                                placeholder="Giá tiền *"
                                name="productPrice"
                                th:field="*{priceInput}"
                                required
                        />
                        <p th:if="${priceError != null}" th:text="${priceError}" style="color: red"></p>
                    </div>
                </div>
                <div th:if="${post.getProduct().getBattery() != null}" class="battery active">
                    <div class="registration__form-group">
                        <select class="registration__select" name="productStatus" th:field="*{product.status}" required>
                            <option value="USED">Đã qua sử dụng</option>
                            <option value="NEW">Mới</option>
                        </select>
                    </div>

                    <div class="registration__form-group">
                        <input
                                type="text"
                                class="registration__input"
                                placeholder="Hãng pin *"
                                th:field="*{product.battery.brand}"
                                required
                        />
                    </div>

                    <div class="registration__form-group">
                        <input
                                type="text"
                                class="registration__input"
                                placeholder="Năm sản xuất *"
                                th:field="*{product.battery.yearOfManufacture}"
                                required
                        />
                        <p th:if="${yearError != null}" th:text="${yearError}" style="color: red"></p>
                    </div>

                    <div class="registration__form-row">
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="text"
                                    class="registration__input"
                                    placeholder="Xuất xứ *"
                                    th:field="*{product.battery.origin}"
                                    required
                            />
                        </div>
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="number"
                                    class="registration__input"
                                    placeholder="Dung lượng(Ah)*"
                                    th:field="*{product.battery.capacity}"
                                    required
                            />
                        </div>
                    </div>

                    <div class="registration__form-row">
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="text"
                                    class="registration__input"
                                    placeholder="Tình trạng pin *"
                                    th:field="*{product.battery.condition}"
                                    required
                            />
                        </div>
                        <div
                                class="registration__form-group registration__form-group--half"
                        >
                            <input
                                    type="text"
                                    class="registration__input"
                                    placeholder="Điện áp(V) *"
                                    th:field="*{product.battery.voltage}"
                                    required
                            />
                            <p th:if="${voltageError != null}" th:text="${voltageError}" style="color: red"></p>
                        </div>
                    </div>

                    <div class="registration__form-group">
                        <input
                                type="text"
                                class="registration__input"
                                placeholder="Giá tiền *"
                                th:field="*{priceInput}"
                                required
                        />
                        <p th:if="${priceError != null}" th:text="${priceError}" style="color: red"></p>
                    </div>
                </div>
            </div>
        </div>
        <input type="submit" class="registration__submit-button" value="CẬP NHẬT TIN" />
    </form>
</div>
<!-- =============================
     FOOTER SECTION
     ============================= -->
<footer th:include="/commonComponents/footer.html"></footer>

<script th:src="@{/js/postFormPage.js}"></script>
</body>
</html>